# yaml-language-server: $schema=../../src/config/schema.json#/definitions/ComponentConfig
#
# Sometimes we have dependencies or event inter-components dependencies
# (for instance when reusing images)
# This examples ensures that the 'base:image' is built before 'dependent'
# and that the file test.html
#
# (FYI: EMB will check and fail if it detects circular dependencies)
resources:
  image:
    type: docker/image
    dependencies:
      - base:image
      - dependencies.txt
    params:
      buildArgs:
        BASE_IMAGE: emb/base:${env:DOCKER_TAG}

  dependencies.txt:
    type: file
    params:
      # The script used to generate the file
      script: | # shell
        echo "Something" > dependencies.txt

tasks:
  test:
    script: | # shell
      grep -i "something" dependencies.txt
      grep -i "base:image" dependencies.txt
